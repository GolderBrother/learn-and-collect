<html lang="en"><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>珠峰架构师成长计划</title>
    <link rel="stylesheet" type="text/css" href="../static/css/main.css">
</head>
<body>
<div class="nav">
    <div class="logo">
        
            珠峰架构师成长计划
        
    </div>
<ul><li><a href="../index.html">0.Async</a></li><li><a href="../html/0.editor.html">0.editor</a></li><li><a href="../html/0.module.html">0.module</a></li><li><a href="../html/1.ES2015.html">1.ES2015</a></li><li><a href="../html/2.Promise.html">2.Promise</a></li><li><a href="../html/3.Node.html">3.Node</a></li><li><a href="../html/4.NodeInstall.html">4.NodeInstall</a></li><li><a href="../html/5.REPL.html">5.REPL</a></li><li><a href="../html/6.NodeCore.html">6.NodeCore</a></li><li><a href="../html/7.module&amp;NPM.html">7.module&amp;NPM</a></li><li><a href="../html/8.Encoding.html">8.Encoding</a></li><li><a href="../html/9.Buffer.html">9.Buffer</a></li><li><a href="../html/10.fs.html">10.fs</a></li><li><a href="../html/11.Stream-1.html">11.Stream-1</a></li><li><a href="../html/11.Stream-2.html">11.Stream-2</a></li><li><a href="../html/11.Stream-3.html">11.Stream-3</a></li><li><a href="../html/11.Stream-4.html">11.Stream-4</a></li><li><a href="../html/12-Network-2.html">12-Network-2</a></li><li><a href="../html/12.NetWork-3.html">12.NetWork-3</a></li><li><a href="../html/12.Network-1.html">12.Network-1</a></li><li><a href="../html/13.tcp.html">13.tcp</a></li><li><a href="../html/14.http-1.html">14.http-1</a></li><li><a href="../html/14.http-2.html">14.http-2</a></li><li><a href="../html/15.compress.html">15.compress</a></li><li><a href="../html/16.crypto.html">16.crypto</a></li><li><a href="../html/17.process.html">17.process</a></li><li><a href="../html/18.yargs.html">18.yargs</a></li><li><a href="../html/19.cache.html">19.cache</a></li><li><a href="../html/20.action.html">20.action</a></li><li><a href="../html/21.https.html">21.https</a></li><li><a href="../html/22.cookie.html">22.cookie</a></li><li><a href="../html/23.session.html">23.session</a></li><li><a href="../html/24.express-1.html">24.express-1</a></li><li><a href="../html/24.express-2.html">24.express-2</a></li><li><a href="../html/24.express-3.html">24.express-3</a></li><li><a href="../html/24.express-4.html">24.express-4</a></li><li><a href="../html/25.koa-1.html">25.koa-1</a></li><li class="active"><a href="../html/26.webpack-1-basic.html">26.webpack-1-basic</a></li><li><a href="../html/26.webpack-2-optimize.html">26.webpack-2-optimize</a></li><li><a href="../html/26.webpack-3.tapable.html">26.webpack-3.tapable</a></li><li><a href="../html/26.webpack-4-AST.html">26.webpack-4-AST</a></li><li><a href="../html/26.webpack-5-source.html">26.webpack-5-source</a></li><li><a href="../html/26.webpack-6-loader.html">26.webpack-6-loader</a></li><li><a href="../html/26.webpack-7-plugin.html">26.webpack-7-plugin</a></li><li><a href="../html/26.webpack-8-hand.html">26.webpack-8-hand</a></li><li><a href="../html/27.react-1.html">27.react-1</a></li><li><a href="../html/27.react-2.html">27.react-2</a></li><li><a href="../html/27.react-3.html">27.react-3</a></li><li><a href="../html/27.react-4-immutable.html">27.react-4-immutable</a></li><li><a href="../html/27.react-5-react-dom-diff.html">27.react-5-react-dom-diff</a></li><li><a href="../html/27.react-6.html">27.react-6</a></li><li><a href="../html/28.react-mobx.html">28.react-mobx</a></li><li><a href="../html/28.redux-0.html">28.redux-0</a></li><li><a href="../html/28.redux-1.html">28.redux-1</a></li><li><a href="../html/28.redux-2-中间件.html">28.redux-2-中间件</a></li><li><a href="../html/28.redux-3-saga.html">28.redux-3-saga</a></li><li><a href="../html/28.redux-jwt-back.html">28.redux-jwt-back</a></li><li><a href="../html/28.redux-jwt-front.html">28.redux-jwt-front</a></li><li><a href="../html/29.mongodb-1.html">29.mongodb-1</a></li><li><a href="../html/29.mongodb-2.html">29.mongodb-2</a></li><li><a href="../html/29.mongodb-3.html">29.mongodb-3</a></li><li><a href="../html/29.mongodb-4.html">29.mongodb-4</a></li><li><a href="../html/29.mongodb-5.html">29.mongodb-5</a></li><li><a href="../html/29.mongodb-6.html">29.mongodb-6</a></li><li><a href="../html/30.cms-1-mysql.html">30.cms-1-mysql</a></li><li><a href="../html/30.cms-2-mysql.html">30.cms-2-mysql</a></li><li><a href="../html/30.cms-3-mysql.html">30.cms-3-mysql</a></li><li><a href="../html/30.cms-4-egg.html">30.cms-4-egg</a></li><li><a href="../html/30.cms-5-api.html">30.cms-5-api</a></li><li><a href="../html/30.cms-6-roadhog.html">30.cms-6-roadhog</a></li><li><a href="../html/30.cms-7-umi.html">30.cms-7-umi</a></li><li><a href="../html/30.cms-8-dva.html">30.cms-8-dva</a></li><li><a href="../html/30.cms-9-dva.html">30.cms-9-dva</a></li><li><a href="../html/30.cms-10-dva.html">30.cms-10-dva</a></li><li><a href="../html/30.cms-11-front.html">30.cms-11-front</a></li><li><a href="../html/31.cms-12-api.html">31.cms-12-api</a></li><li><a href="../html/31.cms-13-front.html">31.cms-13-front</a></li><li><a href="../html/31.cms-14-deploy.html">31.cms-14-deploy</a></li><li><a href="../html/32.ant.html">32.ant</a></li><li><a href="../html/33.redis.html">33.redis</a></li><li><a href="../html/34.unittest.html">34.unittest</a></li><li><a href="../html/35.jwt.html">35.jwt</a></li><li><a href="../html/36.websocket-1.html">36.websocket-1</a></li><li><a href="../html/36.websocket-2.html">36.websocket-2</a></li><li><a href="../html/38.chat-api-1.html">38.chat-api-1</a></li><li><a href="../html/38.chat-api-2.html">38.chat-api-2</a></li><li><a href="../html/38.chat-3.html">38.chat-3</a></li><li><a href="../html/38.chat-api-3.html">38.chat-api-3</a></li><li><a href="../html/38.chat.html">38.chat</a></li><li><a href="../html/38.chat2.html">38.chat2</a></li><li><a href="../html/38.chat2.html">38.chat2</a></li><li><a href="../html/39.crawl-0.html">39.crawl-0</a></li><li><a href="../html/39.crawl-1.html">39.crawl-1</a></li><li><a href="../html/39.crawl-2.html">39.crawl-2</a></li><li><a href="../html/40.deploy.html">40.deploy</a></li><li><a href="../html/41.safe.html">41.safe</a></li><li><a href="../html/42.test.html">42.test</a></li><li><a href="../html/43.nginx.html">43.nginx</a></li><li><a href="../html/44.enzyme.html">44.enzyme</a></li><li><a href="../html/45.docker.html">45.docker</a></li><li><a href="../html/46.elastic.html">46.elastic</a></li><li><a href="../html/47.oauth.html">47.oauth</a></li><li><a href="../html/48.wxpay.html">48.wxpay</a></li><li><a href="../html/49.nunjucks.html">49.nunjucks</a></li><li><a href="../html/50.ketang.html">50.ketang</a></li><li><a href="../html/index.html">index</a></li><li><a href="../html/51.typescript.html">51.typescript</a></li><li><a href="../html/52.UML.html">52.UML</a></li><li><a href="../html/53.design.html">53.design</a></li><li><a href="../html/index.html">index</a></li></ul></div>


<div class="warpper">

    <div class="page-toc">
        <ul><li><a href="#t01. 什么是WebPack">1. 什么是WebPack</a></li><li><a href="#t12. 初始化项目">2. 初始化项目</a></li><li><a href="#t23. 快速上手">3. 快速上手</a><ul><li><a href="#t33.1 webpack核心概念">3.1 webpack核心概念</a></li><li><a href="#t43.2 配置webpack">3.2 配置webpack</a><ul><li><a href="#t53.2.1 创建src目录">3.2.1 创建src目录</a></li><li><a href="#t63.2.2 创建dist目录">3.2.2 创建dist目录</a></li><li><a href="#t73.2.3 基本配置文件">3.2.3 基本配置文件</a></li><li><a href="#t83.2.4 创建index.html文件">3.2.4 创建index.html文件</a></li></ul></li></ul></li><li><a href="#t94. 配置开发服务器">4. 配置开发服务器</a></li><li><a href="#t105. 支持加载css文件">5. 支持加载css文件</a><ul><li><a href="#t115.1 什么是Loader">5.1 什么是Loader</a></li><li><a href="#t125.2 loader三种写法">5.2 loader三种写法</a><ul><li><a href="#t135.2.1 loader">5.2.1 loader</a></li><li><a href="#t145.2.2 use">5.2.2 use</a></li><li><a href="#t155.2.3 use+loader">5.2.3 use+loader</a></li></ul></li></ul></li><li><a href="#t166. 插件">6. 插件</a><ul><li><a href="#t176.1 自动产出html">6.1 自动产出html</a></li></ul></li><li><a href="#t187. 支持图片">7. 支持图片</a><ul><li><a href="#t197.1 手动添加图片">7.1 手动添加图片</a></li><li><a href="#t207.2 JS中引入图片">7.2 JS中引入图片</a><ul><li><a href="#t217.2.1 JS">7.2.1 JS</a></li><li><a href="#t227.2.2 webpack.config.js">7.2.2 webpack.config.js</a></li></ul></li><li><a href="#t237.3 在CSS中引入图片">7.3 在CSS中引入图片</a><ul><li><a href="#t247.3.1 CSS">7.3.1 CSS</a></li><li><a href="#t257.3.2 HTML">7.3.2 HTML</a></li></ul></li></ul></li><li><a href="#t268. 分离CSS">8. 分离CSS</a><ul><li><a href="#t278.1  安装依赖模块">8.1  安装依赖模块</a></li><li><a href="#t288.2 配置webpack.config.js">8.2 配置webpack.config.js</a></li><li><a href="#t298.3 压缩JS和CSS">8.3 压缩JS和CSS</a></li><li><a href="#t308.3 css和image存放单独目录">8.3 css和image存放单独目录</a></li><li><a href="#t318.3 在HTML中使用图片">8.3 在HTML中使用图片</a></li></ul></li><li><a href="#t329. 编译less 和 sass">9. 编译less 和 sass</a><ul><li><a href="#t339.1 安装less">9.1 安装less</a></li><li><a href="#t349.2 编写样式">9.2 编写样式</a></li></ul></li><li><a href="#t3510. 处理CSS3属性前缀">10. 处理CSS3属性前缀</a></li><li><a href="#t3611. 转义ES6/ES7/JSX">11. 转义ES6/ES7/JSX</a><ul><li><a href="#t3711.1  安装依赖包">11.1  安装依赖包</a></li><li><a href="#t3811.2 decorator">11.2 decorator</a></li><li><a href="#t3911.3 webpack.config.js">11.3 webpack.config.js</a></li><li><a href="#t4011.4 babel runtime">11.4 babel runtime</a></li><li><a href="#t4111.5 ESLint校验代码格式规范">11.5 ESLint校验代码格式规范</a></li></ul></li><li><a href="#t4212. 如何调试打包后的代码">12. 如何调试打包后的代码</a></li><li><a href="#t4313.打包第三方类库">13.打包第三方类库</a><ul><li><a href="#t4413.1 直接引入">13.1 直接引入</a></li><li><a href="#t4513.2 插件引入">13.2 插件引入</a></li><li><a href="#t4613.3 expose-loader">13.3 expose-loader</a></li><li><a href="#t4713.4 externals">13.4 externals</a></li></ul></li><li><a href="#t4814. watch">14. watch</a></li><li><a href="#t4915. 添加商标">15. 添加商标</a></li><li><a href="#t5016. 拷贝静态文件">16. 拷贝静态文件</a></li><li><a href="#t5117. 打包前先清空输出目录">17. 打包前先清空输出目录</a></li><li><a href="#t5218. 服务器代理">18. 服务器代理</a><ul><li><a href="#t5318.1 不修改路径">18.1 不修改路径</a></li><li><a href="#t5418.2 修改路径">18.2 修改路径</a></li><li><a href="#t5518.3 before after">18.3 before after</a></li><li><a href="#t5618.4 webpack-dev-middleware">18.4 webpack-dev-middleware</a></li></ul></li><li><a href="#t5719. resolve解析">19. resolve解析</a><ul><li><a href="#t5819.1 extensions">19.1 extensions</a></li><li><a href="#t5919.2 alias">19.2 alias</a></li><li><a href="#t6019.3 modules">19.3 modules</a></li><li><a href="#t6119.4 mainFields">19.4 mainFields</a></li><li><a href="#t6219.5 mainFiles">19.5 mainFiles</a></li><li><a href="#t6319.6 resolveLoader">19.6 resolveLoader</a></li></ul></li><li><a href="#t6420. noParse">20. noParse</a></li><li><a href="#t6521. DefinePlugin">21. DefinePlugin</a></li><li><a href="#t6622. IgnorePlugin">22. IgnorePlugin</a></li><li><a href="#t6720. 区分环境变量">20. 区分环境变量</a><ul><li><a href="#t6820.1 环境差异">20.1 环境差异</a></li><li><a href="#t6920.2 获取mode参数">20.2 获取mode参数</a></li><li><a href="#t7020.3 封装log方法">20.3 封装log方法</a></li><li><a href="#t7120.4 拆分配置">20.4 拆分配置</a></li></ul></li><li><a href="#t7221. 多入口">21. 多入口</a></li><li><a href="#t7322. 对图片进行压缩和优化">22. 对图片进行压缩和优化</a></li><li><a href="#t74参考">参考</a><ul><li><a href="#t75参考文档">参考文档</a></li><li><a href="#t76常用loader列表">常用loader列表</a><ul><li><a href="#t77文件">文件</a></li><li><a href="#t78JSON">JSON</a></li><li><a href="#t79转换编译(Transpiling)">转换编译(Transpiling)</a></li><li><a href="#t80模板(Templating)">模板(Templating)</a></li><li><a href="#t81样式">样式</a></li><li><a href="#t82清理和测试(Linting &amp;&amp; Testing)">清理和测试(Linting &amp;&amp; Testing)</a></li><li><a href="#t83框架(Frameworks)">框架(Frameworks)</a></li></ul></li></ul></li></ul>
    </div>
    
    <div class="content markdown-body">
        <h2 id="t01. 什么是WebPack">1. 什么是WebPack <a href="#t01. 什么是WebPack"> # </a></h2>
<p>WebPack可以看做是模块打包机：它做的事情是，分析你的项目结构，找到JavaScript模块以及其它的一些浏览器不能直接运行的拓展语言（Scss，TypeScript等），并将其打包为合适的格式以供浏览器使用。</p>
<p><img src="http://img.zhufengpeixun.cn/webpack.jpeg" alt="webpack"></p>
<p>构建就是把源代码转换成发布到线上的可执行 JavaScrip、CSS、HTML 代码，包括如下内容。</p>
<ul>
<li>代码转换：TypeScript 编译成 JavaScript、SCSS 编译成 CSS 等。</li>
<li>文件优化：压缩 JavaScript、CSS、HTML 代码，压缩合并图片等。</li>
<li>代码分割：提取多个页面的公共代码、提取首屏不需要执行部分的代码让其异步加载。</li>
<li>模块合并：在采用模块化的项目里会有很多个模块和文件，需要构建功能把模块分类合并成一个文件。</li>
<li>自动刷新：监听本地源代码的变化，自动重新构建、刷新浏览器。</li>
<li>代码校验：在代码被提交到仓库前需要校验代码是否符合规范，以及单元测试是否通过。</li>
<li>自动发布：更新完代码后，自动构建出线上发布代码并传输给发布系统。</li>
</ul>
<p>构建其实是工程化、自动化思想在前端开发中的体现，把一系列流程用代码去实现，让代码自动化地执行这一系列复杂的流程。 构建给前端开发注入了更大的活力，解放了我们的生产力。</p>
<h2 id="t12. 初始化项目">2. 初始化项目 <a href="#t12. 初始化项目"> # </a></h2>
<pre><code class="lang-js">mkdir zhufeng-webpack
cd zhufeng-webpack
npm init -y
</code></pre>
<h2 id="t23. 快速上手">3. 快速上手 <a href="#t23. 快速上手"> # </a></h2>
<h3 id="t33.1 webpack核心概念">3.1 webpack核心概念 <a href="#t33.1 webpack核心概念"> # </a></h3>
<ul>
<li>Entry：入口，Webpack 执行构建的第一步将从 Entry 开始，可抽象成输入。</li>
<li>Module：模块，在 Webpack 里一切皆模块，一个模块对应着一个文件。Webpack 会从配置的 Entry 开始递归找出所有依赖的模块。</li>
<li>Chunk：代码块，一个 Chunk 由多个模块组合而成，用于代码合并与分割。</li>
<li>Loader：模块转换器，用于把模块原内容按照需求转换成新内容。</li>
<li>Plugin：扩展插件，在 Webpack 构建流程中的特定时机注入扩展逻辑来改变构建结果或做你想要的事情。</li>
<li>Output：输出结果，在 Webpack 经过一系列处理并得出最终想要的代码后输出结果。</li>
</ul>
<blockquote>
<p>Webpack 启动后会从<code>Entry</code>里配置的<code>Module</code>开始递归解析 Entry 依赖的所有 Module。 每找到一个 Module， 就会根据配置的<code>Loader</code>去找出对应的转换规则，对 Module 进行转换后，再解析出当前 Module 依赖的 Module。 这些模块会以 Entry 为单位进行分组，一个 Entry 和其所有依赖的 Module 被分到一个组也就是一个 <code>Chunk</code>。最后 Webpack 会把所有 Chunk 转换成文件输出。 在整个流程中 Webpack 会在恰当的时机执行 Plugin 里定义的逻辑。</p>
</blockquote>
<h3 id="t43.2 配置webpack">3.2 配置webpack <a href="#t43.2 配置webpack"> # </a></h3>
<pre><code class="lang-js">npm install webpack webpack-cli -D
</code></pre>
<h4 id="t53.2.1 创建src目录">3.2.1 创建src目录 <a href="#t53.2.1 创建src目录"> # </a></h4>
<pre><code class="lang-js">mkdir src
</code></pre>
<h4 id="t63.2.2 创建dist目录">3.2.2 创建dist目录 <a href="#t63.2.2 创建dist目录"> # </a></h4>
<pre><code class="lang-js">mkdir dist
</code></pre>
<h4 id="t73.2.3 基本配置文件">3.2.3 基本配置文件 <a href="#t73.2.3 基本配置文件"> # </a></h4>
<pre><code class="lang-js"><span class="hljs-keyword">const</span> path=<span class="hljs-built_in">require</span>(<span class="hljs-string">'path'</span>);
<span class="hljs-built_in">module</span>.exports={
    <span class="hljs-attr">entry</span>: <span class="hljs-string">'./src/index.js'</span>,
    <span class="hljs-attr">output</span>: {
        <span class="hljs-attr">path</span>: path.resolve(__dirname,<span class="hljs-string">'dist'</span>),
        <span class="hljs-attr">filename</span>:<span class="hljs-string">'bundle.js'</span>
    },
    <span class="hljs-attr">module</span>: {},
    <span class="hljs-attr">plugins</span>: [],
    <span class="hljs-attr">devServer</span>: {}
}
</code></pre>
<ul>
<li>创建dist<ul>
<li>创建index.html</li>
</ul>
</li>
<li>配置文件webpack.config.js<ul>
<li>entry：配置入口文件的地址</li>
<li>output：配置出口文件的地址</li>
<li>module：配置模块,主要用来配置不同文件的加载器</li>
<li>plugins：配置插件</li>
<li>devServer：配置开发服务器</li>
</ul>
</li>
</ul>
<pre><code class="lang-js"><span class="hljs-keyword">const</span> path=<span class="hljs-built_in">require</span>(<span class="hljs-string">'path'</span>);
<span class="hljs-built_in">module</span>.exports={
    <span class="hljs-attr">entry</span>: <span class="hljs-string">'./src/index.js'</span>,
    <span class="hljs-attr">output</span>: {
        <span class="hljs-attr">path</span>: path.resolve(__dirname,<span class="hljs-string">'dist'</span>),
        <span class="hljs-attr">filename</span>:<span class="hljs-string">'bundle.js'</span>
    },
    <span class="hljs-attr">module</span>: {},
    <span class="hljs-attr">plugins</span>: [],
    <span class="hljs-attr">devServer</span>: {}
}
</code></pre>
<h4 id="t83.2.4 创建index.html文件">3.2.4 创建index.html文件 <a href="#t83.2.4 创建index.html文件"> # </a></h4>
<p>在dist目录下创建index.html文件</p>
<pre><code class="lang-html"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">"X-UA-Compatible"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"ie=edge"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Document<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"root"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"bundle.js"</span>&gt;</span><span class="undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<h2 id="t94. 配置开发服务器">4. 配置开发服务器 <a href="#t94. 配置开发服务器"> # </a></h2>
<pre><code class="lang-js">npm i webpack-dev-server –D
</code></pre>
<ul>
<li>contentBase 配置开发服务运行时的文件根目录</li>
<li>host：开发服务器监听的主机地址</li>
<li>compress 开发服务器是否启动gzip等压缩</li>
<li>port：开发服务器监听的端口</li>
</ul>
<pre><code class="lang-diff"><span class="hljs-addition">+ devServer:{</span>
<span class="hljs-addition">+        contentBase:path.resolve(__dirname,'dist'),</span>
<span class="hljs-addition">+        host:'localhost',</span>
<span class="hljs-addition">+        compress:true,</span>
<span class="hljs-addition">+        port:8080</span>
<span class="hljs-addition">+ }</span>
</code></pre>
<pre><code class="lang-diff"><span class="hljs-addition">+  "scripts": {</span>
<span class="hljs-addition">+    "build": "webpack --mode development",</span>
<span class="hljs-addition">+    "dev": "webpack-dev-server --open --mode development "</span>
<span class="hljs-addition">+  }</span>
</code></pre>
<h2 id="t105. 支持加载css文件">5. 支持加载css文件 <a href="#t105. 支持加载css文件"> # </a></h2>
<h3 id="t115.1 什么是Loader">5.1 什么是Loader <a href="#t115.1 什么是Loader"> # </a></h3>
<p>通过使用不同的Loader，Webpack可以要把不同的文件都转成JS文件,比如CSS、ES6/7、JSX等</p>
<ul>
<li>test：匹配处理文件的扩展名的正则表达式</li>
<li>use：loader名称，就是你要使用模块的名称</li>
<li>include/exclude:手动指定必须处理的文件夹或屏蔽不需要处理的文件夹</li>
<li>query：为loaders提供额外的设置选项</li>
</ul>
<h3 id="t125.2 loader三种写法">5.2 loader三种写法 <a href="#t125.2 loader三种写法"> # </a></h3>
<ul>
<li><a href="https://www.npmjs.com/package/css-loader">css-loader</a></li>
<li><a href="https://www.npmjs.com/package/style-loader">style-loader</a></li>
</ul>
<h4 id="t135.2.1 loader">5.2.1 loader <a href="#t135.2.1 loader"> # </a></h4>
<p>加载CSS文件，CSS文件有可能在node_modules里，比如bootstrap和antd</p>
<pre><code class="lang-diff">module: {
        rules: [
            {
                test: /\.css/,
<span class="hljs-addition">+                loader:['style-loader','css-loader']</span>
            }
        ]
    }
</code></pre>
<h4 id="t145.2.2 use">5.2.2 use <a href="#t145.2.2 use"> # </a></h4>
<pre><code class="lang-diff">module: {
        rules: [
            {
                test: /\.css/,
<span class="hljs-addition">+                use:['style-loader','css-loader']</span>
            }
        ]
    },
</code></pre>
<h4 id="t155.2.3 use+loader">5.2.3 use+loader <a href="#t155.2.3 use+loader"> # </a></h4>
<pre><code class="lang-js">    <span class="hljs-built_in">module</span>: {
        <span class="hljs-attr">rules</span>: [
            {
                <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.css/</span>,
                <span class="hljs-attr">include</span>: path.resolve(__dirname,<span class="hljs-string">'src'</span>),
                <span class="hljs-attr">exclude</span>: <span class="hljs-regexp">/node_modules/</span>,
                <span class="hljs-attr">use</span>: [{
                    <span class="hljs-attr">loader</span>: <span class="hljs-string">'style-loader'</span>,
                    <span class="hljs-attr">options</span>: {
                        <span class="hljs-attr">insertAt</span>:<span class="hljs-string">'top'</span>
                    }
                },<span class="hljs-string">'css-loader'</span>]
            }
        ]
    }
</code></pre>
<h2 id="t166. 插件">6. 插件 <a href="#t166. 插件"> # </a></h2>
<ul>
<li>在 webpack 的构建流程中，plugin 用于处理更多其他的一些构建任务</li>
<li>模块代码转换的工作由 loader 来处理</li>
<li>除此之外的其他任何工作都可以交由 plugin 来完成</li>
</ul>
<h3 id="t176.1 自动产出html">6.1 自动产出html <a href="#t176.1 自动产出html"> # </a></h3>
<p>我们希望自动能产出HTML文件，并在里面引入产出后的资源</p>
<pre><code class="lang-js">npm i html-webpack-plugin -D
</code></pre>
<ul>
<li>minify 是对html文件进行压缩，removeAttrubuteQuotes是去掉属性的双引号</li>
<li>hash 引入产出资源的时候加上查询参数，值为哈希避免缓存</li>
<li>template 模版路径</li>
</ul>
<pre><code class="lang-diff">    plugins: [
<span class="hljs-addition">+        new HtmlWebpackPlugin({</span>
<span class="hljs-addition">+         minify: {</span>
<span class="hljs-addition">+            removeAttributeQuotes:true</span>
<span class="hljs-addition">+        },</span>
<span class="hljs-addition">+        hash: true,</span>
<span class="hljs-addition">+        template: './src/index.html',</span>
<span class="hljs-addition">+        filename:'index.html'</span>
    })]
</code></pre>
<h2 id="t187. 支持图片">7. 支持图片 <a href="#t187. 支持图片"> # </a></h2>
<h3 id="t197.1 手动添加图片">7.1 手动添加图片 <a href="#t197.1 手动添加图片"> # </a></h3>
<pre><code class="lang-js">npm i file-loader url-loader -D
</code></pre>
<ul>
<li><a href="http://npmjs.com/package/file-loader">file-loader</a> 解决CSS等文件中的引入图片路径问题</li>
<li><a href="https://www.npmjs.com/package/url-loader">url-loader</a> 当图片小于limit的时候会把图片BASE64编码，大于limit参数的时候还是使用file-loader 进行拷贝</li>
</ul>
<h3 id="t207.2 JS中引入图片">7.2 JS中引入图片 <a href="#t207.2 JS中引入图片"> # </a></h3>
<h4 id="t217.2.1 JS">7.2.1 JS <a href="#t217.2.1 JS"> # </a></h4>
<pre><code class="lang-js"><span class="hljs-keyword">let</span> logo=<span class="hljs-built_in">require</span>(<span class="hljs-string">'./images/logo.png'</span>);
<span class="hljs-keyword">let</span> img=<span class="hljs-keyword">new</span> Image();
img.src=logo;
<span class="hljs-built_in">document</span>.body.appendChild(img);
</code></pre>
<h4 id="t227.2.2 webpack.config.js">7.2.2 webpack.config.js <a href="#t227.2.2 webpack.config.js"> # </a></h4>
<pre><code class="lang-js">{
  <span class="hljs-attr">test</span>:<span class="hljs-regexp">/\.(jpg|png|bmp|gif|svg|ttf|woff|woff2|eot)/</span>,
    <span class="hljs-attr">use</span>:[
    {
       <span class="hljs-attr">loader</span>:<span class="hljs-string">'url-loader'</span>,
       <span class="hljs-attr">options</span>:{<span class="hljs-attr">limit</span>:<span class="hljs-number">4096</span>}
    }
  ]
}
</code></pre>
<h3 id="t237.3 在CSS中引入图片">7.3 在CSS中引入图片 <a href="#t237.3 在CSS中引入图片"> # </a></h3>
<p>还可以在CSS文件中引入图片</p>
<h4 id="t247.3.1 CSS">7.3.1 CSS <a href="#t247.3.1 CSS"> # </a></h4>
<pre><code class="lang-css"><span class="hljs-selector-class">.logo</span>{
    <span class="hljs-attribute">width</span>:<span class="hljs-number">355px</span>;
    <span class="hljs-attribute">height</span>:<span class="hljs-number">133px</span>;
    <span class="hljs-attribute">background-image</span>: <span class="hljs-built_in">url</span>(./images/logo.png);
    <span class="hljs-attribute">background-size</span>: cover;
}
</code></pre>
<h4 id="t257.3.2 HTML">7.3.2 HTML <a href="#t257.3.2 HTML"> # </a></h4>
<pre><code class="lang-html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"logo"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre>
<h2 id="t268. 分离CSS">8. 分离CSS <a href="#t268. 分离CSS"> # </a></h2>
<p>因为CSS的下载和JS可以并行,当一个HTML文件很大的时候，我们可以把CSS单独提取出来加载</p>
<ul>
<li><a href="https://github.com/webpack-contrib/mini-css-extract-plugin">mini-css-extract-plugin</a></li>
<li>filename 打包入口文件</li>
<li>chunkFilename 用来打包<code>import('module')</code>方法中引入的模块</li>
</ul>
<h3 id="t278.1  安装依赖模块">8.1  安装依赖模块 <a href="#t278.1  安装依赖模块"> # </a></h3>
<pre><code class="lang-js">npm install --save-dev mini-css-extract-plugin
</code></pre>
<h3 id="t288.2 配置webpack.config.js">8.2 配置webpack.config.js <a href="#t288.2 配置webpack.config.js"> # </a></h3>
<pre><code class="lang-diff">plugins: [
       //参数类似于webpackOptions.output
<span class="hljs-addition">+        new MiniCssExtractPlugin({</span>
<span class="hljs-addition">+            filename: '[name].css',</span>
<span class="hljs-addition">+            chunkFilename:'[id].css'</span>
<span class="hljs-addition">+        }),</span>

{
                test: /\.css/,
                include: path.resolve(__dirname,'src'),
                exclude: /node_modules/,
                use: [{
<span class="hljs-addition">+                    loader: MiniCssExtractPlugin.loader</span>
                },'css-loader']
            }
</code></pre>
<h3 id="t298.3 压缩JS和CSS">8.3 压缩JS和CSS <a href="#t298.3 压缩JS和CSS"> # </a></h3>
<pre><code class="lang-js">npm i uglifyjs-webpack-plugin optimize-css-assets-webpack-plugin -D
</code></pre>
<pre><code class="lang-js"><span class="hljs-keyword">const</span> UglifyJsPlugin = <span class="hljs-built_in">require</span>(<span class="hljs-string">"uglifyjs-webpack-plugin"</span>);
<span class="hljs-keyword">const</span> OptimizeCSSAssetsPlugin = <span class="hljs-built_in">require</span>(<span class="hljs-string">"optimize-css-assets-webpack-plugin"</span>);
<span class="hljs-built_in">module</span>.exports = {
    <span class="hljs-attr">mode</span>: <span class="hljs-string">'development'</span>,
    <span class="hljs-attr">optimization</span>: {
        <span class="hljs-attr">minimizer</span>: [
            <span class="hljs-keyword">new</span> UglifyJsPlugin({
                <span class="hljs-attr">cache</span>: <span class="hljs-literal">true</span>,<span class="hljs-comment">//启动缓存</span>
                parallel: <span class="hljs-literal">true</span>,<span class="hljs-comment">//启动并行压缩</span>
                <span class="hljs-comment">//如果为true的话，可以获得sourcemap</span>
                sourceMap: <span class="hljs-literal">true</span> <span class="hljs-comment">// set to true if you want JS source maps</span>
            }),
            <span class="hljs-comment">//压缩css资源的</span>
            <span class="hljs-keyword">new</span> OptimizeCSSAssetsPlugin({})
        ]
    },
</code></pre>
<h3 id="t308.3 css和image存放单独目录">8.3 css和image存放单独目录 <a href="#t308.3 css和image存放单独目录"> # </a></h3>
<ul>
<li>outputPath 输出路径</li>
<li>publicPath指定的是构建后在html里的路径</li>
</ul>
<pre><code class="lang-diff">output: {
        path: path.resolve(__dirname,'dist'),
        filename: 'bundle.js',
<span class="hljs-addition">+        publicPath:'/'</span>
    },
{
  test:/\.(jpg|jpeg|png|bmp|gif|svg|ttf|woff|woff2|eot)/,
  use:[
        {
          loader:'url-loader',
          options:{
              limit: 4096,
<span class="hljs-addition">+              outputPath: 'images',</span>
<span class="hljs-addition">+              publicPath:'/images'</span>
          }
        }
     ]
}

plugins: [
        new MiniCssExtractPlugin({
<span class="hljs-addition">+            filename: 'css/[name].css',</span>
<span class="hljs-addition">+            chunkFilename:'css/[id].css'</span>
        }),
</code></pre>
<h3 id="t318.3 在HTML中使用图片">8.3 在HTML中使用图片 <a href="#t318.3 在HTML中使用图片"> # </a></h3>
<pre><code class="lang-js">npm i html-withimg-loader -D
</code></pre>
<p>index.html</p>
<pre><code class="lang-js">&lt;img src=<span class="hljs-string">"./images/logo.png"</span>/&gt;
</code></pre>
<p>webpack.config.js</p>
<pre><code class="lang-diff">{
<span class="hljs-addition">+                test: /\.(html|htm)$/,</span>
<span class="hljs-addition">+                use: 'html-withimg-loader'</span>
}
</code></pre>
<h2 id="t329. 编译less 和 sass">9. 编译less 和 sass <a href="#t329. 编译less 和 sass"> # </a></h2>
<h3 id="t339.1 安装less">9.1 安装less <a href="#t339.1 安装less"> # </a></h3>
<pre><code class="lang-js">npm i less less-loader -D
npm i node-sass sass-loader -D
</code></pre>
<h3 id="t349.2 编写样式">9.2 编写样式 <a href="#t349.2 编写样式"> # </a></h3>
<p>less</p>
<pre><code class="lang-css">@color:orange;
.less-container{
    color:@color;
}
</code></pre>
<p>sass</p>
<pre><code>$color:green;
.sass-container{
    color:green;
}
</code></pre><p>webpack.config.js</p>
<pre><code class="lang-js">   {
        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.less/</span>,
        <span class="hljs-attr">include</span>: path.resolve(__dirname,<span class="hljs-string">'src'</span>),
        <span class="hljs-attr">exclude</span>: <span class="hljs-regexp">/node_modules/</span>,
        <span class="hljs-attr">use</span>: [{
            <span class="hljs-attr">loader</span>: MiniCssExtractPlugin.loader,
        },<span class="hljs-string">'css-loader'</span>,<span class="hljs-string">'less-loader'</span>]
    },
    {
        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.scss/</span>,
        <span class="hljs-attr">include</span>: path.resolve(__dirname,<span class="hljs-string">'src'</span>),
        <span class="hljs-attr">exclude</span>: <span class="hljs-regexp">/node_modules/</span>,
        <span class="hljs-attr">use</span>: [{
            <span class="hljs-attr">loader</span>: MiniCssExtractPlugin.loader,
        },<span class="hljs-string">'css-loader'</span>,<span class="hljs-string">'sass-loader'</span>]
    },
</code></pre>
<h2 id="t3510. 处理CSS3属性前缀">10. 处理CSS3属性前缀 <a href="#t3510. 处理CSS3属性前缀"> # </a></h2>
<p>为了浏览器的兼容性，有时候我们必须加入-webkit,-ms,-o,-moz这些前缀</p>
<ul>
<li>Trident内核：主要代表为IE浏览器, 前缀为-ms</li>
<li>Gecko内核：主要代表为Firefox, 前缀为-moz</li>
<li>Presto内核：主要代表为Opera, 前缀为-o</li>
<li>Webkit内核：产要代表为Chrome和Safari, 前缀为-webkit<pre><code class="lang-js">npm i postcss-loader autoprefixer -D
</code></pre>
<a href="https://github.com/postcss/postcss-loader">postcss-loader</a></li>
</ul>
<p>index.css</p>
<pre><code class="lang-css"><span class="hljs-selector-pseudo">::placeholder</span> {
    <span class="hljs-attribute">color</span>: red;
}
</code></pre>
<p>postcss.config.js</p>
<pre><code class="lang-js"><span class="hljs-built_in">module</span>.exports={
    <span class="hljs-attr">plugins</span>:[<span class="hljs-built_in">require</span>(<span class="hljs-string">'autoprefixer'</span>)]
}
</code></pre>
<p>webpack.config.js</p>
<pre><code class="lang-js">{
   <span class="hljs-attr">test</span>:<span class="hljs-regexp">/\.css$/</span>,
   <span class="hljs-attr">use</span>:[MiniCssExtractPlugin.loader,<span class="hljs-string">'css-loader'</span>,<span class="hljs-string">'postcss-loader'</span>],
   <span class="hljs-attr">include</span>:path.join(__dirname,<span class="hljs-string">'./src'</span>),
   <span class="hljs-attr">exclude</span>:<span class="hljs-regexp">/node_modules/</span>
}
</code></pre>
<h2 id="t3611. 转义ES6/ES7/JSX">11. 转义ES6/ES7/JSX <a href="#t3611. 转义ES6/ES7/JSX"> # </a></h2>
<ul>
<li>Babel其实是一个编译JavaScript的平台,可以把ES6/ES7,React的JSX转义为ES5</li>
<li><a href="https://babeljs.io/docs/en/babel-plugin-proposal-decorators">babel-plugin-proposal-decorators</a></li>
</ul>
<h3 id="t3711.1  安装依赖包">11.1  安装依赖包 <a href="#t3711.1  安装依赖包"> # </a></h3>
<pre><code class="lang-js">npm i babel-loader @babel/core @babel/preset-env  @babel/preset-react  -D
npm i @babel/plugin-proposal-decorators @babel/plugin-proposal-<span class="hljs-class"><span class="hljs-keyword">class</span>-<span class="hljs-title">properties</span> -<span class="hljs-title">D</span>
</span></code></pre>
<h3 id="t3811.2 decorator">11.2 decorator <a href="#t3811.2 decorator"> # </a></h3>
<pre><code class="lang-js"><span class="hljs-comment">//Option+Shift+A</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">readonly</span>(<span class="hljs-params">target,key,discriptor</span>) </span>{
    discriptor.writable=<span class="hljs-literal">false</span>;
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Person</span></span>{
    @readonly PI=<span class="hljs-number">3.14</span>;
}
<span class="hljs-keyword">let</span> p1=<span class="hljs-keyword">new</span> Person();
p1.PI=<span class="hljs-number">3.15</span>;
<span class="hljs-built_in">console</span>.log(p1)
</code></pre>
<p>jsconfig.json</p>
<pre><code class="lang-json">{
    <span class="hljs-attr">"compilerOptions"</span>: {
        <span class="hljs-attr">"experimentalDecorators"</span>: <span class="hljs-literal">true</span>
    }
}
</code></pre>
<h3 id="t3911.3 webpack.config.js">11.3 webpack.config.js <a href="#t3911.3 webpack.config.js"> # </a></h3>
<pre><code class="lang-js">{
    <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.jsx?$/</span>,
    <span class="hljs-attr">use</span>: {
        <span class="hljs-attr">loader</span>: <span class="hljs-string">'babel-loader'</span>,
        <span class="hljs-attr">options</span>:{
         <span class="hljs-string">"plugins"</span>: [
            [<span class="hljs-string">"@babel/plugin-proposal-decorators"</span>, { <span class="hljs-string">"legacy"</span>: <span class="hljs-literal">true</span> }],
            [<span class="hljs-string">"@babel/plugin-proposal-class-properties"</span>, { <span class="hljs-string">"loose"</span> : <span class="hljs-literal">true</span> }]
         ]
        }
    },
    <span class="hljs-attr">include</span>: path.join(__dirname,<span class="hljs-string">'src'</span>),
    <span class="hljs-attr">exclude</span>:<span class="hljs-regexp">/node_modules/</span>
}
</code></pre>
<h3 id="t4011.4 babel runtime">11.4 babel runtime <a href="#t4011.4 babel runtime"> # </a></h3>
<ul>
<li>babel 在每个文件都插入了辅助代码，使代码体积过大</li>
<li>babel 对一些公共方法使用了非常小的辅助代码，比如 <code>_extend</code></li>
<li>默认情况下会被添加到每一个需要它的文件中。你可以引入 <code>@babel/runtime</code> 作为一个独立模块，来避免重复引入</li>
<li><a href="https://babeljs.io/docs/en/babel-plugin-transform-runtime">babel-plugin-transform-runtime</a></li>
</ul>
<pre><code class="lang-js">npm install --save-dev @babel/plugin-transform-runtime
npm install --save @babel/runtime
</code></pre>
<p>.babelrc</p>
<pre><code class="lang-js">{
  <span class="hljs-string">"presets"</span>: [<span class="hljs-string">"@babel/preset-env"</span>],
  <span class="hljs-string">"plugins"</span>: [
   [
         <span class="hljs-string">"@babel/plugin-transform-runtime"</span>,
         {
            <span class="hljs-string">"corejs"</span>: <span class="hljs-literal">false</span>,
            <span class="hljs-string">"helpers"</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-string">"regenerator"</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-string">"useESModules"</span>: <span class="hljs-literal">true</span>
        }
    ]
  ]
}
</code></pre>
<blockquote>
<p>webpack打包的时候，会自动优化重复引入公共方法的问题</p>
</blockquote>
<h3 id="t4111.5 ESLint校验代码格式规范">11.5 ESLint校验代码格式规范 <a href="#t4111.5 ESLint校验代码格式规范"> # </a></h3>
<ul>
<li><a href="https://eslint.org/docs/developer-guide/nodejs-api#cliengine">eslint</a></li>
<li><a href="https://www.npmjs.com/package/eslint-loader">eslint-loader</a></li>
<li><a href="https://eslint.org/docs/user-guide/configuring">configuring</a></li>
<li><a href="https://www.npmjs.com/package/babel-eslint">babel-eslint</a></li>
<li><a href="https://cloud.tencent.com/developer/chapter/12618">Rules</a></li>
<li><a href="https://segmentfault.com/a/1190000008742240">ESlint 语法检测配置说明</a><pre><code class="lang-js">npm install eslint eslint-loader babel-eslint --D
</code></pre>
</li>
</ul>
<p>.eslintrc.js</p>
<pre><code class="lang-js"><span class="hljs-built_in">module</span>.exports = {
    <span class="hljs-attr">root</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-comment">//指定解析器选项</span>
    parserOptions: {
        <span class="hljs-attr">sourceType</span>: <span class="hljs-string">'module'</span>
    },
    <span class="hljs-comment">//指定脚本的运行环境</span>
    env: {
        <span class="hljs-attr">browser</span>: <span class="hljs-literal">true</span>,
    },
    <span class="hljs-comment">// 启用的规则及其各自的错误级别</span>
    rules: {
        <span class="hljs-string">"indent"</span>: [<span class="hljs-string">"error"</span>, <span class="hljs-number">4</span>],<span class="hljs-comment">//缩进风格</span>
        <span class="hljs-string">"quotes"</span>: [<span class="hljs-string">"error"</span>, <span class="hljs-string">"double"</span>],<span class="hljs-comment">//引号类型 </span>
        <span class="hljs-string">"semi"</span>: [<span class="hljs-string">"error"</span>, <span class="hljs-string">"always"</span>],<span class="hljs-comment">//关闭语句强制分号结尾</span>
        <span class="hljs-string">"no-console"</span>: <span class="hljs-string">"error"</span>,<span class="hljs-comment">//禁止使用console</span>
        <span class="hljs-string">"arrow-parens"</span>: <span class="hljs-number">0</span> <span class="hljs-comment">//箭头函数用小括号括起来</span>
    }
}
</code></pre>
<pre><code class="lang-js"><span class="hljs-built_in">module</span>: {
        <span class="hljs-comment">//配置加载规则</span>
        rules: [
            {
                <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.js$/</span>,
                <span class="hljs-attr">loader</span>: <span class="hljs-string">'eslint-loader'</span>,
                <span class="hljs-attr">enforce</span>: <span class="hljs-string">"pre"</span>,
                <span class="hljs-attr">include</span>: [path.resolve(__dirname, <span class="hljs-string">'src'</span>)], <span class="hljs-comment">// 指定检查的目录</span>
                options: { <span class="hljs-attr">fix</span>: <span class="hljs-literal">true</span> } <span class="hljs-comment">// 这里的配置项参数将会被传递到 eslint 的 CLIEngine   </span>
            },
</code></pre>
<h2 id="t4212. 如何调试打包后的代码">12. 如何调试打包后的代码 <a href="#t4212. 如何调试打包后的代码"> # </a></h2>
<p>webpack通过配置可以自动给我们<code>source maps</code>文件，<code>map</code>文件是一种对应编译文件和源文件的方法</p>
<ul>
<li>source-map 把映射文件生成到单独的文件，最完整最慢</li>
<li>cheap-module-source-map 在一个单独的文件中产生一个不带列映射的Map</li>
<li>eval-source-map 使用eval打包源文件模块,在同一个文件中生成完整sourcemap</li>
<li>cheap-module-eval-source-map sourcemap和打包后的JS同行显示，没有映射列</li>
</ul>
<pre><code class="lang-js">devtool:<span class="hljs-string">'eval-source-map'</span>
</code></pre>
<h2 id="t4313.打包第三方类库">13.打包第三方类库 <a href="#t4313.打包第三方类库"> # </a></h2>
<h3 id="t4413.1 直接引入">13.1 直接引入 <a href="#t4413.1 直接引入"> # </a></h3>
<pre><code class="lang-js"><span class="hljs-keyword">import</span> _ <span class="hljs-keyword">from</span> <span class="hljs-string">'lodash'</span>;
alert(_.join([<span class="hljs-string">'a'</span>,<span class="hljs-string">'b'</span>,<span class="hljs-string">'c'</span>],<span class="hljs-string">'@'</span>));
</code></pre>
<h3 id="t4513.2 插件引入">13.2 插件引入 <a href="#t4513.2 插件引入"> # </a></h3>
<ul>
<li>_ 函数会自动添加到当前模块的上下文，无需显示声明</li>
</ul>
<pre><code class="lang-js"> + <span class="hljs-keyword">new</span> webpack.ProvidePlugin({
 +     _:<span class="hljs-string">'lodash'</span>
 + })
</code></pre>
<blockquote>
<p>没有全局的<code>$</code>函数，所以导入依赖全局变量的插件依旧会失败</p>
</blockquote>
<h3 id="t4613.3 expose-loader">13.3 expose-loader <a href="#t4613.3 expose-loader"> # </a></h3>
<p>不需要任何其他的插件配合，只要将下面的代码添加到所有的loader之前</p>
<pre><code class="lang-js"><span class="hljs-built_in">require</span>(<span class="hljs-string">"expose-loader?libraryName!./file.js"</span>);
</code></pre>
<pre><code class="lang-js">{ 
    <span class="hljs-attr">test</span>: <span class="hljs-built_in">require</span>.resolve(<span class="hljs-string">"jquery"</span>), 
    <span class="hljs-attr">loader</span>: <span class="hljs-string">"expose-loader?jQuery"</span>
}
</code></pre>
<pre><code class="lang-js"><span class="hljs-built_in">require</span>(<span class="hljs-string">"expose-loader?$!jquery"</span>);
</code></pre>
<h3 id="t4713.4 externals">13.4 externals <a href="#t4713.4 externals"> # </a></h3>
<p>如果我们想引用一个库，但是又不想让webpack打包，并且又不影响我们在程序中以CMD、AMD或者window/global全局等方式进行使用，那就可以通过配置externals</p>
<pre><code class="lang-js"> <span class="hljs-keyword">const</span> jQuery = <span class="hljs-built_in">require</span>(<span class="hljs-string">"jquery"</span>);
 <span class="hljs-keyword">import</span> jQuery <span class="hljs-keyword">from</span> <span class="hljs-string">'jquery'</span>;
</code></pre>
<pre><code class="lang-js">+ externals: {
+         jquery: <span class="hljs-string">'jQuery'</span><span class="hljs-comment">//如果要在浏览器中运行，那么不用添加什么前缀，默认设置就是global</span>
+ },
<span class="hljs-attr">module</span>: {
</code></pre>
<h2 id="t4814. watch">14. watch <a href="#t4814. watch"> # </a></h2>
<p>当代码发生修改后可以自动重新编译</p>
<pre><code class="lang-js">watch: <span class="hljs-literal">true</span>,
<span class="hljs-attr">watchOptions</span>: {
    <span class="hljs-attr">ignored</span>: <span class="hljs-regexp">/node_modules/</span>, <span class="hljs-comment">//忽略不用监听变更的目录</span>
    poll:<span class="hljs-number">1000</span>, <span class="hljs-comment">//每秒询问的文件变更的次数</span>
    aggregateTimeout: <span class="hljs-number">500</span>, <span class="hljs-comment">//防止重复保存频繁重新编译,500毫秒内重复保存不打包</span>
}
</code></pre>
<ul>
<li>webpack定时获取文件的更新时间，并跟上次保存的时间进行比对，不一致就表示发生了变化,poll就用来配置每秒问多少次</li>
<li>当检测文件不再发生变化，会先缓存起来，等待一段时间后之后再通知监听者，这个等待时间通过<code>aggregateTimeout</code>配置</li>
<li>webpack只会监听entry依赖的文件</li>
<li>我们需要尽可能减少需要监听的文件数量和检查频率，当然频率的降低会导致灵敏度下降</li>
</ul>
<h2 id="t4915. 添加商标">15. 添加商标 <a href="#t4915. 添加商标"> # </a></h2>
<pre><code class="lang-js">+ <span class="hljs-keyword">new</span> webpack.BannerPlugin(<span class="hljs-string">'珠峰培训'</span>),
</code></pre>
<h2 id="t5016. 拷贝静态文件">16. 拷贝静态文件 <a href="#t5016. 拷贝静态文件"> # </a></h2>
<p>有时项目中没有引用的文件也需要打包到目标目录</p>
<pre><code>npm i copy-webpack-plugin -D
</code></pre><pre><code class="lang-js"><span class="hljs-keyword">new</span> CopyWebpackPlugin([{
  <span class="hljs-attr">from</span>: path.resolve(__dirname,<span class="hljs-string">'src/assets'</span>),<span class="hljs-comment">//静态资源目录源地址</span>
  to:path.resolve(__dirname,<span class="hljs-string">'dist/assets'</span>) <span class="hljs-comment">//目标地址，相对于output的path目录</span>
}])
</code></pre>
<h2 id="t5117. 打包前先清空输出目录">17. 打包前先清空输出目录 <a href="#t5117. 打包前先清空输出目录"> # </a></h2>
<pre><code class="lang-js">npm i  clean-webpack-plugin -D
</code></pre>
<pre><code class="lang-js"><span class="hljs-keyword">new</span> CleanWebpackPlugin([path.resolve(__dirname,<span class="hljs-string">'dist'</span>)])
</code></pre>
<h2 id="t5218. 服务器代理">18. 服务器代理 <a href="#t5218. 服务器代理"> # </a></h2>
<p>如果你有单独的后端开发服务器 API，并且希望在同域名下发送 API 请求 ，那么代理某些 URL 会很有用。</p>
<h3 id="t5318.1 不修改路径">18.1 不修改路径 <a href="#t5318.1 不修改路径"> # </a></h3>
<p>//请求到 /api/users 现在会被代理到请求 <a href="http://localhost:3000/api/users。">http://localhost:3000/api/users。</a></p>
<pre><code class="lang-js">proxy: {
  <span class="hljs-string">"/api"</span>: <span class="hljs-string">'http://localhost:3000'</span>
}
</code></pre>
<h3 id="t5418.2 修改路径">18.2 修改路径 <a href="#t5418.2 修改路径"> # </a></h3>
<pre><code class="lang-js">proxy: {
    <span class="hljs-string">"/api"</span>: {
       <span class="hljs-attr">target</span>: <span class="hljs-string">'http://localhost:3000'</span>,
       <span class="hljs-attr">pathRewrite</span>:{<span class="hljs-string">"^/api"</span>:<span class="hljs-string">""</span>}        
    }            
}
</code></pre>
<h3 id="t5518.3 before after">18.3 before after <a href="#t5518.3 before after"> # </a></h3>
<p>before 在 webpack-dev-server 静态资源中间件处理之前，可以用于拦截部分请求返回特定内容，或者实现简单的数据 mock。</p>
<pre><code class="lang-js">before(app){
  app.get(<span class="hljs-string">'/api/users'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">req, res</span>) </span>{ 
    res.json([{<span class="hljs-attr">id</span>:<span class="hljs-number">1</span>,<span class="hljs-attr">name</span>:<span class="hljs-string">'zfpx1'</span>}])
  })
}
</code></pre>
<h3 id="t5618.4 webpack-dev-middleware">18.4 webpack-dev-middleware <a href="#t5618.4 webpack-dev-middleware"> # </a></h3>
<p><a href="https://www.npmjs.com/package/">webpack-dev-middleware</a>就是在 Express 中提供 webpack-dev-server 静态服务能力的一个中间件</p>
<pre><code class="lang-js">npm install webpack-dev-middleware --save-dev
</code></pre>
<pre><code class="lang-js"><span class="hljs-keyword">const</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">'express'</span>);
<span class="hljs-keyword">const</span> app = express();
<span class="hljs-keyword">const</span> webpack = <span class="hljs-built_in">require</span>(<span class="hljs-string">'webpack'</span>);
<span class="hljs-keyword">const</span> webpackDevMiddleware = <span class="hljs-built_in">require</span>(<span class="hljs-string">'webpack-dev-middleware'</span>);
<span class="hljs-keyword">const</span> webpackOptions = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./webpack.config'</span>);
webpackOptions.mode = <span class="hljs-string">'development'</span>;
<span class="hljs-keyword">const</span> compiler = webpack(webpackOptions);
app.use(webpackDevMiddleware(compiler, {}));
app.listen(<span class="hljs-number">3000</span>);
</code></pre>
<ul>
<li>webpack-dev-server 的好处是相对简单，直接安装依赖后执行命令即可</li>
<li>而使用<code>webpack-dev-middleware</code>的好处是可以在既有的 Express 代码基础上快速添加 webpack-dev-server 的功能，同时利用 Express 来根据需要添加更多的功能，如 mock 服务、代理 API 请求等</li>
</ul>
<h2 id="t5719. resolve解析">19. resolve解析 <a href="#t5719. resolve解析"> # </a></h2>
<h3 id="t5819.1 extensions">19.1 extensions <a href="#t5819.1 extensions"> # </a></h3>
<p>指定extension之后可以不用在<code>require</code>或是<code>import</code>的时候加文件扩展名,会依次尝试添加扩展名进行匹配</p>
<pre><code class="lang-js">resolve: {
  <span class="hljs-attr">extensions</span>: [<span class="hljs-string">".js"</span>,<span class="hljs-string">".jsx"</span>,<span class="hljs-string">".json"</span>,<span class="hljs-string">".css"</span>]
},
</code></pre>
<h3 id="t5919.2 alias">19.2 alias <a href="#t5919.2 alias"> # </a></h3>
<p>配置别名可以加快webpack查找模块的速度</p>
<ul>
<li>每当引入bootstrap模块的时候，它会直接引入<code>bootstrap</code>,而不需要从<code>node_modules</code>文件夹中按模块的查找规则查找</li>
</ul>
<pre><code class="lang-js"><span class="hljs-keyword">const</span> bootstrap = path.resolve(__dirname,<span class="hljs-string">'node_modules/_bootstrap@3.3.7@bootstrap/dist/css/bootstrap.css'</span>);
resolve: {
+    alias:{
+        <span class="hljs-string">"bootstrap"</span>:bootstrap
+    }
},
</code></pre>
<h3 id="t6019.3 modules">19.3 modules <a href="#t6019.3 modules"> # </a></h3>
<ul>
<li>对于直接声明依赖名的模块（如 react ），webpack 会类似 Node.js 一样进行路径搜索，搜索<code>node_modules</code>目录</li>
<li>这个目录就是使用<code>resolve.modules</code>字段进行配置的
默认配置<pre><code class="lang-js">resolve: {
<span class="hljs-attr">modules</span>: [<span class="hljs-string">'node_modules'</span>],
}
</code></pre>
如果可以确定项目内所有的第三方依赖模块都是在项目根目录下的 node_modules 中的话<pre><code class="lang-js">resolve: {
<span class="hljs-attr">modules</span>: [path.resolve(__dirname, <span class="hljs-string">'node_modules'</span>)],
}
</code></pre>
</li>
</ul>
<h3 id="t6119.4 mainFields">19.4 mainFields <a href="#t6119.4 mainFields"> # </a></h3>
<p>默认情况下package.json 文件则按照文件中 main 字段的文件名来查找文件</p>
<pre><code class="lang-js">resolve: {
  <span class="hljs-comment">// 配置 target === "web" 或者 target === "webworker" 时 mainFields 默认值是：</span>
  mainFields: [<span class="hljs-string">'browser'</span>, <span class="hljs-string">'module'</span>, <span class="hljs-string">'main'</span>],
  <span class="hljs-comment">// target 的值为其他时，mainFields 默认值为：</span>
  mainFields: [<span class="hljs-string">"module"</span>, <span class="hljs-string">"main"</span>],
}
</code></pre>
<h3 id="t6219.5 mainFiles">19.5 mainFiles <a href="#t6219.5 mainFiles"> # </a></h3>
<p>当目录下没有 package.json 文件时，我们说会默认使用目录下的 index.js 这个文件，其实这个也是可以配置的</p>
<pre><code class="lang-js">resolve: {
  <span class="hljs-attr">mainFiles</span>: [<span class="hljs-string">'index'</span>], <span class="hljs-comment">// 你可以添加其他默认使用的文件名</span>
},
</code></pre>
<h3 id="t6319.6 resolveLoader">19.6 resolveLoader <a href="#t6319.6 resolveLoader"> # </a></h3>
<p><code>resolve.resolveLoader</code>用于配置解析 loader 时的 resolve 配置,默认的配置：</p>
<pre><code class="lang-js"><span class="hljs-built_in">module</span>.exports = {
  <span class="hljs-attr">resolveLoader</span>: {
    <span class="hljs-attr">modules</span>: [ <span class="hljs-string">'node_modules'</span> ],
    <span class="hljs-attr">extensions</span>: [ <span class="hljs-string">'.js'</span>, <span class="hljs-string">'.json'</span> ],
    <span class="hljs-attr">mainFields</span>: [ <span class="hljs-string">'loader'</span>, <span class="hljs-string">'main'</span> ]
  }
};
</code></pre>
<h2 id="t6420. noParse">20. noParse <a href="#t6420. noParse"> # </a></h2>
<ul>
<li><code>module.noParse</code> 字段，可以用于配置哪些模块文件的内容不需要进行解析</li>
<li>不需要解析依赖（即无依赖） 的第三方大型类库等，可以通过这个字段来配置，以提高整体的构建速度<pre><code class="lang-js"><span class="hljs-built_in">module</span>.exports = {
<span class="hljs-comment">// ...</span>
<span class="hljs-built_in">module</span>: {
  <span class="hljs-attr">noParse</span>: <span class="hljs-regexp">/jquery|lodash/</span>, <span class="hljs-comment">// 正则表达式</span>
  <span class="hljs-comment">// 或者使用函数</span>
  noParse(content) {
    <span class="hljs-keyword">return</span> <span class="hljs-regexp">/jquery|lodash/</span>.test(content)
  },
}
}...
</code></pre>
<blockquote>
<p>使用 noParse 进行忽略的模块文件中不能使用 import、require、define 等导入机制</p>
</blockquote>
</li>
</ul>
<h2 id="t6521. DefinePlugin">21. DefinePlugin <a href="#t6521. DefinePlugin"> # </a></h2>
<p><code>DefinePlugin</code>创建一些在编译时可以配置的全局常量</p>
<pre><code class="lang-js"><span class="hljs-keyword">new</span> webpack.DefinePlugin({
    <span class="hljs-attr">PRODUCTION</span>: <span class="hljs-built_in">JSON</span>.stringify(<span class="hljs-literal">true</span>),
    <span class="hljs-attr">VERSION</span>: <span class="hljs-string">"1"</span>,
    <span class="hljs-attr">EXPRESSION</span>: <span class="hljs-string">"1+2"</span>,
    <span class="hljs-attr">COPYRIGHT</span>: {
        <span class="hljs-attr">AUTHOR</span>: <span class="hljs-built_in">JSON</span>.stringify(<span class="hljs-string">"珠峰培训"</span>)
    }
})
</code></pre>
<pre><code class="lang-js"><span class="hljs-built_in">console</span>.log(PRODUCTION);
<span class="hljs-built_in">console</span>.log(VERSION);
<span class="hljs-built_in">console</span>.log(EXPRESSION);
<span class="hljs-built_in">console</span>.log(COPYRIGHT);
</code></pre>
<ul>
<li>如果配置的值是字符串，那么整个字符串会被当成代码片段来执行，其结果作为最终变量的值</li>
<li>如果配置的值不是字符串，也不是一个对象字面量，那么该值会被转为一个字符串，如 true，最后的结果是 'true'</li>
<li>如果配置的是一个对象字面量，那么该对象的所有 key 会以同样的方式去定义</li>
<li>JSON.stringify(true) 的结果是 'true'</li>
</ul>
<h2 id="t6622. IgnorePlugin">22. IgnorePlugin <a href="#t6622. IgnorePlugin"> # </a></h2>
<p>IgnorePlugin用于忽略某些特定的模块，让 webpack 不把这些指定的模块打包进去</p>
<pre><code class="lang-js"><span class="hljs-keyword">import</span> moment <span class="hljs-keyword">from</span>  <span class="hljs-string">'moment'</span>;
<span class="hljs-built_in">console</span>.log(moment);
</code></pre>
<pre><code class="lang-js"><span class="hljs-keyword">new</span> webpack.IgnorePlugin(<span class="hljs-regexp">/^\.\/locale/</span>,/moment$/)
</code></pre>
<ul>
<li>第一个是匹配引入模块路径的正则表达式</li>
<li>第二个是匹配模块的对应上下文，即所在目录名</li>
</ul>
<h2 id="t6720. 区分环境变量">20. 区分环境变量 <a href="#t6720. 区分环境变量"> # </a></h2>
<ul>
<li>日常的前端开发工作中，一般都会有两套构建环境</li>
<li>一套开发时使用，构建结果用于本地开发调试，不进行代码压缩，打印 debug 信息，包含 sourcemap 文件</li>
<li>一套构建后的结果是直接应用于线上的，即代码都是压缩后，运行时不打印 debug 信息，静态文件不包括 sourcemap</li>
<li>webpack 4.x 版本引入了 <code>mode</code> 的概念</li>
<li>当你指定使用 production mode 时，默认会启用各种性能优化的功能，包括构建结果优化以及 webpack 运行性能优化</li>
<li>而如果是 development mode 的话，则会开启 debug 工具，运行时打印详细的错误信息，以及更加快速的增量编译构建</li>
</ul>
<h3 id="t6820.1 环境差异">20.1 环境差异 <a href="#t6820.1 环境差异"> # </a></h3>
<ul>
<li>生产环境<ul>
<li>可能需要分离 CSS 成单独的文件，以便多个页面共享同一个 CSS 文件</li>
<li>需要压缩 HTML/CSS/JS 代码</li>
<li>需要压缩图片</li>
</ul>
</li>
<li>开发环境<ul>
<li>需要生成 sourcemap 文件</li>
<li>需要打印 debug 信息</li>
<li>需要 live reload 或者 hot reload 的功能...</li>
</ul>
</li>
</ul>
<h3 id="t6920.2 获取mode参数">20.2 获取mode参数 <a href="#t6920.2 获取mode参数"> # </a></h3>
<pre><code class="lang-js">npm install --save-dev optimize-css-assets-webpack-plugin
</code></pre>
<pre><code class="lang-js"><span class="hljs-keyword">const</span> UglifyJSPlugin = <span class="hljs-built_in">require</span>(<span class="hljs-string">'webpack/lib/optimize/UglifyJsPlugin'</span>);
<span class="hljs-keyword">const</span> OptimizeCssAssetsPlugin = <span class="hljs-built_in">require</span>(<span class="hljs-string">'optimize-css-assets-webpack-plugin'</span>);
<span class="hljs-built_in">module</span>.exports=<span class="hljs-function">(<span class="hljs-params">env,argv</span>) =&gt;</span> ({
    <span class="hljs-attr">optimization</span>: {
        <span class="hljs-attr">minimizer</span>: argv.mode == <span class="hljs-string">'production'</span>?[            
            <span class="hljs-keyword">new</span> UglifyJSplugin({
                  <span class="hljs-attr">cache</span>: <span class="hljs-literal">true</span>,<span class="hljs-comment">//启用缓存</span>
                  parallel: <span class="hljs-literal">true</span>,<span class="hljs-comment">// 使用多进程运行改进编译速度</span>
                  sourceMap:<span class="hljs-literal">true</span><span class="hljs-comment">//生成sourceMap映射文件</span>
            }),
            <span class="hljs-keyword">new</span> OptimizeCssAssetsWebpackPlugin({})
        ]:[]
    }
})
</code></pre>
<h3 id="t7020.3 封装log方法">20.3 封装log方法 <a href="#t7020.3 封装log方法"> # </a></h3>
<ul>
<li>webpack 时传递的 mode 参数，是可以在我们的应用代码运行时，通过 process.env.NODE_ENV 这个变量获取</li>
</ul>
<pre><code class="lang-js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">log</span>(<span class="hljs-params">...args</span>) </span>{
    <span class="hljs-keyword">if</span> (process.env.NODE_ENV == <span class="hljs-string">'development'</span>) {
        <span class="hljs-built_in">console</span>.log.apply(<span class="hljs-built_in">console</span>,args);
    }
}
</code></pre>
<h3 id="t7120.4 拆分配置">20.4 拆分配置 <a href="#t7120.4 拆分配置"> # </a></h3>
<p>可以把 webpack 的配置按照不同的环境拆分成多个文件，运行时直接根据环境变量加载对应的配置即可</p>
<ul>
<li>webpack.base.js：基础部分，即多个文件中共享的配置</li>
<li>webpack.development.js：开发环境使用的配置</li>
<li>webpack.production.js：生产环境使用的配置</li>
<li>webpack.test.js：测试环境使用的配置...</li>
<li><a href="https://github.com/survivejs/webpack-merge">webpack-merge</a></li>
</ul>
<pre><code class="lang-js"><span class="hljs-keyword">const</span> { smart } = <span class="hljs-built_in">require</span>(<span class="hljs-string">'webpack-merge'</span>)
<span class="hljs-keyword">const</span> webpack = <span class="hljs-built_in">require</span>(<span class="hljs-string">'webpack'</span>)
<span class="hljs-keyword">const</span> base = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./webpack.base.js'</span>)
<span class="hljs-built_in">module</span>.exports = smart(base, {
  <span class="hljs-attr">module</span>: {
    <span class="hljs-attr">rules</span>: [],
  }
})
</code></pre>
<h2 id="t7221. 多入口">21. 多入口 <a href="#t7221. 多入口"> # </a></h2>
<p>有时候我们的页面可以不止一个HTML页面，会有多个页面，所以就需要多入口</p>
<pre><code class="lang-js"><span class="hljs-keyword">const</span> path=<span class="hljs-built_in">require</span>(<span class="hljs-string">'path'</span>);
<span class="hljs-keyword">const</span> HtmlWebpackPlugin=<span class="hljs-built_in">require</span>(<span class="hljs-string">'html-webpack-plugin'</span>);
<span class="hljs-built_in">module</span>.exports={
    <span class="hljs-attr">entry</span>: {
        <span class="hljs-attr">index</span>: <span class="hljs-string">'./src/index.js'</span>,
        <span class="hljs-attr">login</span>: <span class="hljs-string">'./src/login.js'</span>
    },
    <span class="hljs-attr">output</span>: {
        <span class="hljs-attr">path</span>: path.resolve(__dirname, <span class="hljs-string">'dist'</span>),
        <span class="hljs-attr">filename</span>: <span class="hljs-string">'[name].[hash].js'</span>,
        <span class="hljs-attr">publicPath</span>: <span class="hljs-string">'/'</span>
    },
    <span class="hljs-attr">plugins</span>: [
        <span class="hljs-keyword">new</span> HtmlWebpackPlugin({
            <span class="hljs-attr">minify</span>: {
                <span class="hljs-attr">removeAttributeQuotes</span>: <span class="hljs-literal">true</span>
            },
            <span class="hljs-attr">hash</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-attr">template</span>: <span class="hljs-string">'./src/index.html'</span>,
            <span class="hljs-attr">chunks</span>: [<span class="hljs-string">'index'</span>],
            <span class="hljs-attr">filename</span>: <span class="hljs-string">'index.html'</span>
        }),
        <span class="hljs-keyword">new</span> HtmlWebpackPlugin({
            <span class="hljs-attr">minify</span>: {
                <span class="hljs-attr">removeAttributeQuotes</span>: <span class="hljs-literal">true</span>
            },
            <span class="hljs-attr">hash</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-attr">chunks</span>: [<span class="hljs-string">'login'</span>],
            <span class="hljs-attr">template</span>: <span class="hljs-string">'./src/login.html'</span>,
            <span class="hljs-attr">filename</span>: <span class="hljs-string">'login.html'</span>
        })
    ],
}
</code></pre>
<h2 id="t7322. 对图片进行压缩和优化">22. 对图片进行压缩和优化 <a href="#t7322. 对图片进行压缩和优化"> # </a></h2>
<p><a href="https://www.npmjs.com/package/image-webpack-loader">image-webpack-loader</a>可以帮助我们对图片进行压缩和优化</p>
<pre><code class="lang-js">npm install image-webpack-loader --save-dev
</code></pre>
<pre><code class="lang-diff"> {
          test: /\.(png|svg|jpg|gif|jpeg|ico)$/,
          use: [
            'file-loader',
<span class="hljs-addition">+           {</span>
<span class="hljs-addition">+             loader: 'image-webpack-loader',</span>
<span class="hljs-addition">+             options: {</span>
<span class="hljs-addition">+               mozjpeg: {</span>
<span class="hljs-addition">+                 progressive: true,</span>
<span class="hljs-addition">+                 quality: 65</span>
<span class="hljs-addition">+               },</span>
<span class="hljs-addition">+               optipng: {</span>
<span class="hljs-addition">+                 enabled: false,</span>
<span class="hljs-addition">+               },</span>
<span class="hljs-addition">+               pngquant: {</span>
<span class="hljs-addition">+                 quality: '65-90',</span>
<span class="hljs-addition">+                 speed: 4</span>
<span class="hljs-addition">+               },</span>
<span class="hljs-addition">+               gifsicle: {</span>
<span class="hljs-addition">+                 interlaced: false,</span>
<span class="hljs-addition">+               },</span>
<span class="hljs-addition">+               webp: {</span>
<span class="hljs-addition">+                 quality: 75</span>
<span class="hljs-addition">+               }</span>
<span class="hljs-addition">+             }</span>
<span class="hljs-addition">+           },</span>
          ]
        }
</code></pre>
<h2 id="t74参考">参考 <a href="#t74参考"> # </a></h2>
<h3 id="t75参考文档">参考文档 <a href="#t75参考文档"> # </a></h3>
<ul>
<li><a href="https://gitee.com/zhufengpeixun/webpack-start/commits/master">webpack-start</a></li>
<li><a href="https://webpack.docschina.org/configuration/resolve/">resolve</a></li>
</ul>
<h3 id="t76常用loader列表">常用loader列表 <a href="#t76常用loader列表"> # </a></h3>
<p>webpack 可以使用 loader 来预处理文件。这允许你打包除 JavaScript 之外的任何静态资源。你可以使用 Node.js 来很简单地编写自己的 loader。
<a href="https://github.com/webpack-contrib/awesome-webpack#loaders">awesome-loaders</a></p>
<h4 id="t77文件">文件 <a href="#t77文件"> # </a></h4>
<ul>
<li>raw-loader 加载文件原始内容（utf-8）</li>
<li>val-loader 将代码作为模块执行，并将 exports 转为 JS 代码</li>
<li>url-loader 像 file loader 一样工作，但如果文件小于限制，可以返回 data URL</li>
<li>file-loader 将文件发送到输出文件夹，并返回（相对）URL</li>
</ul>
<h4 id="t78JSON">JSON <a href="#t78JSON"> # </a></h4>
<ul>
<li>json-loader 加载 JSON 文件（默认包含）</li>
<li>json5-loader 加载和转译 JSON 5 文件</li>
<li>cson-loader 加载和转译 CSON 文件</li>
</ul>
<h4 id="t79转换编译(Transpiling)">转换编译(Transpiling) <a href="#t79转换编译(Transpiling)"> # </a></h4>
<ul>
<li>script-loader 在全局上下文中执行一次 JavaScript 文件（如在 script 标签），不需要解析</li>
<li>babel-loader 加载 ES2015+ 代码，然后使用 Babel 转译为 ES5</li>
<li>buble-loader 使用 Bublé 加载 ES2015+ 代码，并且将代码转译为 ES5</li>
<li>traceur-loader 加载 ES2015+ 代码，然后使用 Traceur 转译为 ES5</li>
<li>ts-loader 或 awesome-typescript-loader 像 JavaScript 一样加载 TypeScript 2.0+</li>
<li>coffee-loader 像 JavaScript 一样加载 CoffeeScript</li>
</ul>
<h4 id="t80模板(Templating)">模板(Templating) <a href="#t80模板(Templating)"> # </a></h4>
<ul>
<li>html-loader 导出 HTML 为字符串，需要引用静态资源</li>
<li>pug-loader 加载 Pug 模板并返回一个函数</li>
<li>jade-loader 加载 Jade 模板并返回一个函数</li>
<li>markdown-loader 将 Markdown 转译为 HTML</li>
<li>react-markdown-loader 使用 markdown-parse parser(解析器) 将 Markdown 编译为 React 组件</li>
<li>posthtml-loader 使用 PostHTML 加载并转换 HTML 文件</li>
<li>handlebars-loader 将 Handlebars 转移为 HTML</li>
<li>markup-inline-loader 将内联的 SVG/MathML 文件转换为 HTML。在应用于图标字体，或将 CSS 动画应用于 SVG 时非常有用</li>
</ul>
<h4 id="t81样式">样式 <a href="#t81样式"> # </a></h4>
<ul>
<li>style-loader 将模块的导出作为样式添加到 DOM 中</li>
<li>css-loader 解析 CSS 文件后，使用 import 加载，并且返回 CSS 代码</li>
<li>less-loader 加载和转译 LESS 文件</li>
<li>sass-loader 加载和转译 SASS/SCSS 文件</li>
<li>postcss-loader 使用 PostCSS 加载和转译 CSS/SSS 文件</li>
<li>stylus-loader 加载和转译 Stylus 文件</li>
</ul>
<h4 id="t82清理和测试(Linting &amp;&amp; Testing)">清理和测试(Linting &amp;&amp; Testing) <a href="#t82清理和测试(Linting &amp;&amp; Testing)"> # </a></h4>
<ul>
<li>mocha-loader 使用 mocha 测试（浏览器/NodeJS）</li>
<li>eslint-loader PreLoader，使用 ESLint 清理代码</li>
<li>jshint-loader PreLoader，使用 JSHint 清理代码</li>
<li>jscs-loader PreLoader，使用 JSCS 检查代码样式</li>
<li>coverjs-loader PreLoader，使用 CoverJS 确定测试覆盖率</li>
</ul>
<h4 id="t83框架(Frameworks)">框架(Frameworks) <a href="#t83框架(Frameworks)"> # </a></h4>
<ul>
<li>vue-loader 加载和转译 Vue 组件</li>
<li>polymer-loader 使用选择预处理器(preprocessor)处理，并且 require() 类似一等模块(first-class)的 Web 组件</li>
<li>angular2-template-loader 加载和转译 Angular 组件</li>
</ul>

        <div class="copyright">Powered by <a href="https://github.com/jaywcjlove/idoc" target="_blank">idoc</a>. Dependence <a href="https://nodejs.org">Node.js</a> run.</div>
    </div>
    
</div>

<script src="https://cdn.bootcss.com/jquery/3.0.0/jquery.js"></script>
<script>
$('.warpper .page-toc ul ul li a').on('click',function(){
  $('.warpper .page-toc ul ul li a').removeClass('my-active')
  $(this).addClass('my-active')
})
  // if (!$('.understand-me').length) {
  //   var bar = $(window).height() - $('.navbar ').height() - $('.page-toc').position().top;
  //   var count = bar / 26 / 2;
  //   var barHeight = $('.page-toc').outerHeight();
  //   $('.page-toc li').eq(0).children('a').addClass('red');
  //   var arr = [];
  //   $("h1,h2,h3,h4,h5,h6").each(function () {
  //     arr.push($(this).position().top);
  //   });
  //   var timer
  //   function dark() {
  //     clearTimeout(timer)
  //      timer = setTimeout(function () {
  //      var top = Math.abs($('.page-toc > ul').position().top);
  //      var cur = $('.content').scrollTop();
  //      for (var i = arr.length; i >= 0; i--) {
  //        if (arr[i] <= cur) {
  //          break;
  //        }
  //      }
  //      if (i === -1) {
  //        i = 0;
  //      }
  //      $('.page-toc li a').removeClass('red');
  //      $('.page-toc li').eq(i).children('a').addClass('red');
  //      let height = $('.page-toc li').eq(i).position().top-$('.page-toc').height(); // 如果当前的offset出去了 回到中间可好？
  //      $('.page-toc').scrollTop(height+$('.page-toc').height()/2);
  //    },200)
  //   }

  //   $('.content').on('scroll', dark);
  // }
</script>
<style>

    /* ::-webkit-scrollbar{width:14px;}
    ::-webkit-scrollbar-track{background-color:transparent;}
    ::-webkit-scrollbar-thumb{background-color:transparent;}
    ::-webkit-scrollbar-thumb:hover {background-color:transparent}
    ::-webkit-scrollbar-thumb:active {background-color:transparent} */

    .page-toc > ul .red {
        background: #f3f3f3;
        z-index: 1;
        border-left: 3px solid #009a61;
        -webkit-transition: all .2s ease;
        transition: all .2s ease;
        color: #000
    }





</style>


</body></html>